% -- DIRICHLET PROCESS
\section{Nonparametric Bayesian methods}
$Dir(x|\alpha) = \frac{1}{B(\alpha)} \prod_{k=1}^n x_k^{a_k - 1}$, $B(\alpha) = \frac{\prod_{k=1}^n \Gamma(\alpha_k)}{\Gamma(\sum_{k=1}^n \alpha_k)}$ \\

\textbf{Stick-breaking process}:\\ 
$\beta_{1...k}\sim Beta(1,\alpha)$ and $\rho=\beta_k(1-\sum_{i=1}^{k-1}\rho_i) \Rightarrow \rho\sim GEM(\alpha),\rho=\{\rho_k\}_{k=1}^\infty$ \\
If $\rho\sim GEM(\alpha)$ and $\theta_k\sim H$ for $k=1,2,...$, then $G(\theta)=\sum_{k=1}^\infty \rho_k\delta_{\theta_k}(\theta)$ is a sample from $DP(\alpha,H)$.

\textbf{Chinese rest. process (sampling from DP)}:\\
$P(\text{cust.}_{n+1} \text{ joins table } \tau|\mathcal{P})=$\begin{cases}
      \frac{|\tau|}{\alpha + n} \quad \text{if} \tau\in\mathcal{P} \\
      \frac{\alpha}{\alpha + n} \quad \text{otherwise}
   \end{cases}

$\mathrm{P}(\text{Partition }\mathcal{P})=\frac{\alpha^{|\mathcal{P}|}}{\alpha^{(m)}}\prod_{\tau\in\mathcal{P}}(|\tau|-1)!$

$\mathbb{E}[1] = \sum_{i=1}^N \frac{\alpha}{\alpha + i} \sim(\alpha log(N))$ \\

\textbf{de Finetti}: $(X_1, ..., X_n)$ are inftly exchangeable RVs: $p(X_1, ..., X_n) {=} \int (\prod_{i=1}^n p(x_i|G))dP(G)$ \\
   
\textbf{Finite GMM:}\\
\begin{inparaitem}[\color{black}\textbullet]
    \item Cluster centers: $\mu_k \sim \mathcal{N}(\mu_0, \sigma_0)$ \\
    \item Probs of clusters: $\rho_{1...K}\sim Dir(\alpha_{1...K})$\\
    \item Assignments to clusters: $z_i \sim Categ(\rho_{1...K})$ \\
    \item Coordinates of data points: $x_i \sim \mathcal{N}(\mu_{z_i}, \sigma_{z_i})$
\end{inparaitem}
\textbf{DP Mixture model:} \\
\begin{inparaitem}[\color{black}\textbullet]
    \item Prob.s of clusters: $\rho = (\rho_1, \rho_2,...) \sim  GEM(\alpha)$ \\
    \item Centers of the clusters: $\mu_k \sim \mathcal{N}(\mu_0, \sigma_0)$ \\
    \item Assignments to clusters: $z_i \sim Categorical(\rho)$ \\
    \item Coordinates of data points: $\mathcal{N}(\mu_{z_i}, \sigma)$
\end{inparaitem}

\textbf{Fitting a DPMM: collapsed Gibbs sampler}:\\
\[ p(z_i=k|\bm{z}_{-i},\bm{x},\alpha,\bm{\mu}) = \begin{cases}
      \frac{N_{k,-i}}{\alpha + N - 1} p(x_i|\bm{x}_{-i,k},\bm{\mu}) \;\exists k \\
      \frac{\alpha}{\alpha + N - 1} p(x_i|\bm{\mu}) \;\text{otherwise}
   \end{cases}
\]



